System.register(["jimu-core","jimu-for-builder","jimu-ui/advanced/setting-components","jimu-ui/advanced/resource-selector","jimu-ui","jimu-ui/advanced/data-source-selector","jimu-ui/advanced/expression-builder","jimu-ui/advanced/style-setting-components","jimu-ui/basic/color-picker"],(function(e,t){var s={},i={},o={},n={},r={},a={},p={},l={},g={};return{setters:[function(e){s.ExpressionPartType=e.ExpressionPartType,s.Immutable=e.Immutable,s.LinkType=e.LinkType,s.React=e.React,s.classNames=e.classNames,s.css=e.css,s.defaultMessages=e.defaultMessages,s.expressionUtils=e.expressionUtils,s.jsx=e.jsx,s.polished=e.polished,s.urlUtils=e.urlUtils},function(e){i.builderAppSync=e.builderAppSync},function(e){o.LinkSettingPopup=e.LinkSettingPopup,o.SettingRow=e.SettingRow,o.SettingSection=e.SettingSection},function(e){n.IconPicker=e.IconPicker},function(e){r.BorderSides=e.BorderSides,r.Button=e.Button,r.Collapse=e.Collapse,r.FillType=e.FillType,r.Icon=e.Icon,r.Label=e.Label,r.NormalLineType=e.NormalLineType,r.Select=e.Select,r.Switch=e.Switch,r.Tab=e.Tab,r.Tabs=e.Tabs,r.TextInput=e.TextInput,r.UnitTypes=e.UnitTypes,r.defaultMessages=e.defaultMessages,r.styleUtils=e.styleUtils,r.utils=e.utils},function(e){a.AllDataSourceTypes=e.AllDataSourceTypes,a.DataSourceSelector=e.DataSourceSelector},function(e){p.ExpressionInput=e.ExpressionInput,p.ExpressionInputType=e.ExpressionInputType},function(e){l.BackgroundSetting=e.BackgroundSetting,l.BorderRadiusSetting=e.BorderRadiusSetting,l.BorderSetting=e.BorderSetting,l.BoxShadowSetting=e.BoxShadowSetting,l.InputUnit=e.InputUnit,l.TextStyle=e.TextStyle},function(e){g.ThemeColorPicker=e.ThemeColorPicker}],execute:function(){e((()=>{var e={24786:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2.343 8l1.768-1.768.707.707L3.05 8.707a3 3 0 004.243 4.243l1.767-1.768.708.707L8 13.657A4 4 0 112.343 8zM12.95 7.293l-1.768 1.768.707.707L13.657 8A4 4 0 108 2.343L6.232 4.111l.707.707L8.707 3.05a3 3 0 014.243 4.243z" fill="#000"></path><path d="M5.879 9.414a.5.5 0 00.707.707l3.535-3.535a.5.5 0 00-.707-.707L5.879 9.414z" fill="#000"></path></svg>'},1810:e=>{"use strict";e.exports=s},3297:e=>{"use strict";e.exports=i},21835:e=>{"use strict";e.exports=r},33037:e=>{"use strict";e.exports=a},47460:e=>{"use strict";e.exports=p},50831:e=>{"use strict";e.exports=n},23080:e=>{"use strict";e.exports=o},89820:e=>{"use strict";e.exports=l},43817:e=>{"use strict";e.exports=g}},t={};function u(s){var i=t[s];if(void 0!==i)return i.exports;var o=t[s]={exports:{}};return e[s](o,o.exports,u),o.exports}u.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return u.d(t,{a:t}),t},u.d=(e,t)=>{for(var s in t)u.o(t,s)&&!u.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},u.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),u.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.p="";var c={};return u.p=window.jimuConfig.baseUrl,(()=>{"use strict";u.r(c),u.d(c,{default:()=>E});var e,t=u(1810),s=u(3297),i=u(23080),o=u(50831),n=u(21835),r=u(33037),a=u(47460);!function(e){e.Left="LEFT",e.Right="RIGHT"}(e||(e={}));var p=u(89820);const l=[n.BorderSides.TL,n.BorderSides.TR,n.BorderSides.BR,n.BorderSides.BL];class g extends t.React.PureComponent{constructor(){super(...arguments),this.onBackgroundStyleChange=e=>{var s,i;let o=(0,t.Immutable)(null!==(i=null===(s=this.props.style)||void 0===s?void 0:s.background)&&void 0!==i?i:{});for(const t in e)switch(t){case"fillType":o.fillType!==e[t]&&(o=o.set("fillType",e[t]));break;case"color":o=o.set("color",e[t]);break;case"image":o=o.set("image",e[t])}this.props.onChange(this.getStyleSettings().set("background",o))},this.updateBorder=e=>{this.props.onChange(this.getStyleSettings().set("border",e))},this.updateRadius=e=>{this.props.onChange(this.getStyleSettings().set("borderRadius",e))},this.updateShadow=e=>{this.props.onChange(this.getStyleSettings().set("boxShadow",e))}}getStyleSettings(){return this.props.style?(0,t.Immutable)(this.props.style):(0,t.Immutable)({})}render(){const e=this.props.style||(0,t.Immutable)({});return(0,t.jsx)("div",{className:"common-style-setting"},(0,t.jsx)("div",{className:"mb-3"},(0,t.jsx)(i.SettingRow,{label:this.props.intl.formatMessage({id:"background",defaultMessage:n.defaultMessages.background})}),(0,t.jsx)(i.SettingRow,{role:"group","aria-label":this.props.intl.formatMessage({id:"background",defaultMessage:n.defaultMessages.background})},(0,t.jsx)(p.BackgroundSetting,{background:e.background,onChange:this.onBackgroundStyleChange}))),(0,t.jsx)("div",{className:"mb-3"},(0,t.jsx)(i.SettingRow,{label:this.props.intl.formatMessage({id:"border",defaultMessage:n.defaultMessages.border})}),(0,t.jsx)(i.SettingRow,{role:"group","aria-label":this.props.intl.formatMessage({id:"border",defaultMessage:n.defaultMessages.border})},(0,t.jsx)(p.BorderSetting,{value:e.border,onChange:this.updateBorder})),(0,t.jsx)(i.SettingRow,{label:this.props.intl.formatMessage({id:"borderRadius",defaultMessage:n.defaultMessages.borderRadius})}),(0,t.jsx)(i.SettingRow,{role:"group","aria-label":this.props.intl.formatMessage({id:"borderRadius",defaultMessage:n.defaultMessages.borderRadius})},(0,t.jsx)(p.BorderRadiusSetting,{sides:l,value:e.borderRadius,onChange:this.updateRadius}))),(0,t.jsx)("div",{className:"mb-3"},(0,t.jsx)(i.SettingRow,{label:this.props.intl.formatMessage({id:"shadow",defaultMessage:n.defaultMessages.shadow})}),(0,t.jsx)(i.SettingRow,{role:"group","aria-label":this.props.intl.formatMessage({id:"shadow",defaultMessage:n.defaultMessages.shadow})},(0,t.jsx)(p.BoxShadowSetting,{value:e.boxShadow,onChange:this.updateShadow}))))}}var h=u(43817);class d extends t.React.PureComponent{constructor(){super(...arguments),this.units=[n.UnitTypes.PIXEL],this.onSizeChange=e=>{this.changeIcon("size",e.distance)},this.onColorChange=e=>{this.changeIcon("color",e)},this.changeIcon=(e,s)=>{const i=this.props.iconProps?this.props.iconProps.set(e,s):(0,t.Immutable)({[e]:s});this.props.onChange(i)}}render(){const e=this.props.iconProps||{};return(0,t.jsx)("div",{className:"w-100 d-flex justify-content-between icon-size-font-style-setting"},(0,t.jsx)("div",null,(0,t.jsx)(p.InputUnit,{units:this.units,value:{distance:e.size,unit:n.UnitTypes.PIXEL},onChange:this.onSizeChange})),(0,t.jsx)("div",null,(0,t.jsx)(h.ThemeColorPicker,{specificTheme:this.props.appTheme,value:e.color,onChange:this.onColorChange})))}}class f extends t.React.PureComponent{constructor(){super(...arguments),this.changeText=(e,s)=>{const i=this.props.text?this.props.text.set(e,s):(0,t.Immutable)({[e]:s});this.props.onChange(i)}}render(){return(0,t.jsx)(p.TextStyle,Object.assign({},this.props.text,{onChange:this.changeText}))}}class m extends t.React.PureComponent{constructor(){super(...arguments),this.onTextChange=e=>{const t=this.getStyleFromCustomAndTheme().set("text",e);this.props.onChange(t)},this.onIconChange=e=>{const t=this.getStyleFromCustomAndTheme().set("iconProps",e);this.props.onChange(t)},this.onCommonChange=e=>{const s=this.getStyleFromCustomAndTheme(),i=Object.assign(Object.assign({},s),e);this.props.onChange((0,t.Immutable)(i))},this.getStyleFromCustomAndTheme=()=>{const e=this.props.themeStyle||(0,t.Immutable)({}),s=this.props.style||(0,t.Immutable)({});return e.merge(s)}}render(){const e=this.getStyleFromCustomAndTheme();return(0,t.jsx)("div",{className:"advance-style-setting mt-3"},this.props.isTextSettingOpen&&(0,t.jsx)("div",{className:"mb-3"},(0,t.jsx)(i.SettingRow,{label:this.props.intl.formatMessage({id:"text",defaultMessage:n.defaultMessages.text})}),(0,t.jsx)(i.SettingRow,{role:"group","aria-label":this.props.intl.formatMessage({id:"text",defaultMessage:n.defaultMessages.text})},(0,t.jsx)(f,{appTheme:this.props.appTheme,text:e.text,onChange:this.onTextChange}))),this.props.isIconSettingOpen&&(0,t.jsx)("div",{className:"mb-3"},(0,t.jsx)(i.SettingRow,{label:this.props.intl.formatMessage({id:"icon",defaultMessage:t.defaultMessages.icon})}),(0,t.jsx)(i.SettingRow,{role:"group","aria-label":this.props.intl.formatMessage({id:"icon",defaultMessage:t.defaultMessages.icon})},(0,t.jsx)(d,{appTheme:this.props.appTheme,intl:this.props.intl,iconProps:e.iconProps,onChange:this.onIconChange}))),(0,t.jsx)("div",{className:"mb-3"},(0,t.jsx)(g,{intl:this.props.intl,style:e,onChange:this.onCommonChange})))}}class x extends t.React.PureComponent{render(){return t.React.createElement("div",{className:"w-100"},t.React.createElement("div",{onClick:this.props.toggle,className:"d-flex justify-content-between mb-2"},t.React.createElement("div",null,t.React.createElement(n.Label,{for:"open-collapse",className:"collapse-label"},this.props.title)),t.React.createElement("div",null,t.React.createElement(n.Switch,{id:"open-collapse",name:"open-collapse",onChange:this.props.toggle,checked:this.props.isOpen}))),t.React.createElement(n.Collapse,{isOpen:this.props.isOpen},this.props.children))}}function S(e,s,i){const o=e?"default":"hover",r=(0,t.Immutable)(i),a=r.getIn(["components","button","variants",s,o,"color"]),p=r.getIn(["components","button","sizes","default","fontSize"]);return{color:a,size:parseFloat(n.styleUtils.remToPixel(p))}}var C=u(24786),y=u.n(C);const T=e=>{const{className:s}=e,i=function(e,t){var s={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(s[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(s[i[o]]=e[i[o]])}return s}(e,["className"]),o=(0,t.classNames)("jimu-icon-component",s);return t.React.createElement(n.Icon,Object.assign({className:o,icon:y()},i))},v=(0,t.Immutable)([a.ExpressionInputType.Static,a.ExpressionInputType.Attribute,a.ExpressionInputType.Statistics,a.ExpressionInputType.Expression]),I=(0,t.Immutable)([r.AllDataSourceTypes.FeatureLayer,r.AllDataSourceTypes.SceneLayer]);var b;!function(e){e.hover="HOVER",e.regular="REGULAR"}(b||(b={}));class E extends t.React.PureComponent{constructor(i){var o,r,a,p;super(i),this.linkSettingTrigger=t.React.createRef(),this.toggleLinkSetting=()=>{this.setState({isLinkSettingShown:!this.state.isLinkSettingShown})},this.onSettingLinkConfirm=e=>{let t;if(e){if(e.expression){const s=this.getTextExpression(),i=this.getTipExpression(),o=e.expression,n=this.mergeUseDataSources(s,i,o);t={id:this.props.id,config:this.props.config.setIn(["functionConfig","linkParam"],e),useDataSources:n}}else{let s;if(this.getIsDataSourceUsed()){const e=this.getTextExpression(),t=this.getTipExpression();s=this.mergeUseDataSources(e,t,null)}else s=this.getUseDataSourcesWithoutFields();t={id:this.props.id,config:this.props.config.setIn(["functionConfig","linkParam"],e),useDataSources:s}}this.props.onSettingChange(t),this.setState({isLinkSettingShown:!1})}},this.onTextChange=()=>{const e={id:this.props.id,config:this.props.config.setIn(["functionConfig","text"],this.state.currentTextInput).setIn(["functionConfig","textExpression"],null),useDataSources:this.getUseDataSourcesWithoutFields()};this.props.onSettingChange(e)},this.onToolTipChange=()=>{const e={id:this.props.id,config:this.props.config.setIn(["functionConfig","toolTip"],this.state.currentTipInput).setIn(["functionConfig","toolTipExpression"],null),useDataSources:this.getUseDataSourcesWithoutFields()};this.props.onSettingChange(e)},this.onTextExpChange=e=>{if(!e)return;const s=this.getTipExpression(),i=this.getLinkSettingExpression(),o=this.mergeUseDataSources((0,t.Immutable)(e),s,i);this.props.onSettingChange({id:this.props.id,config:this.props.config.setIn(["functionConfig","textExpression"],e).setIn(["functionConfig","text"],""),useDataSources:o}),this.setState({isTextExpOpen:!1})},this.onTipExpChange=e=>{if(!e)return;const s=this.getTextExpression(),i=this.getLinkSettingExpression(),o=this.mergeUseDataSources(s,(0,t.Immutable)(e),i);this.props.onSettingChange({id:this.props.id,config:this.props.config.setIn(["functionConfig","toolTipExpression"],e).setIn(["functionConfig","toolTip"],""),useDataSources:o}),this.setState({isTipExpOpen:!1})},this.onToggleUseDataEnabled=e=>{var s,i,o,n,r,a;let p=this.props.config;e?(p=p.setIn(["functionConfig","textExpression"],this.getTextExpression()).setIn(["functionConfig","toolTipExpression"],this.getTipExpression()),p=p.set("functionConfig",p.functionConfig.without("text").without("toolTip")),(null===(o=null===(i=null===(s=this.props.config)||void 0===s?void 0:s.functionConfig)||void 0===i?void 0:i.linkParam)||void 0===o?void 0:o.linkType)===t.LinkType.WebAddress&&(p=p.setIn(["functionConfig","linkParam","expression"],this.getLinkSettingExpression()),p=p.setIn(["functionConfig","linkParam"],p.functionConfig.linkParam.without("value")))):(p=p.setIn(["functionConfig","text"],this.state.currentTextInput).setIn(["functionConfig","toolTip"],this.state.currentTipInput),p=p.set("functionConfig",p.functionConfig.without("textExpression").without("toolTipExpression")),(null===(a=null===(r=null===(n=this.props.config)||void 0===n?void 0:n.functionConfig)||void 0===r?void 0:r.linkParam)||void 0===a?void 0:a.linkType)===t.LinkType.WebAddress&&(p=p.setIn(["functionConfig","linkParam","value"],""),p=p.setIn(["functionConfig","linkParam"],p.functionConfig.linkParam.without("expression")))),this.props.onSettingChange({id:this.props.id,useDataSourcesEnabled:e,config:p})},this.onDataSourceChange=e=>{e&&this.props.onSettingChange({id:this.props.id,useDataSources:e})},this.getDefaultIconColor=e=>{const t=e?"regular":"hover";return this.props.config.getIn(["styleConfig","customStyle",t,"iconProps","color"])||this.props.appTheme.colors.dark},this.onIconResultChange=s=>{let i;if(s){i=this.props.config;const t=this.props.config.getIn(["functionConfig","icon","position"])||e.Left,o=this.getDefaultIconColor(!0),n=this.getDefaultIconColor(!1),r=this.props.config.getIn(["styleConfig","customStyle","regular","iconProps","size"])||s.properties.size,a=this.props.config.getIn(["styleConfig","customStyle","hover","iconProps","size"])||s.properties.size;i=i.setIn(["functionConfig","icon","data"],s.svg).setIn(["functionConfig","icon","position"],t).setIn(["styleConfig","customStyle","regular","iconProps","color"],o).setIn(["styleConfig","customStyle","regular","iconProps","size"],r).setIn(["styleConfig","customStyle","hover","iconProps","color"],n).setIn(["styleConfig","customStyle","hover","iconProps","size"],a)}else i=this.props.config.set("functionConfig",this.props.config.functionConfig.without("icon")).setIn(["styleConfig","customStyle","regular"],this.props.config.getIn(["styleConfig","customStyle","regular"],(0,t.Immutable)({})).without("iconProps")).setIn(["styleConfig","customStyle","hover"],this.props.config.getIn(["styleConfig","customStyle","hover"],(0,t.Immutable)({})).without("iconProps"));this.props.onSettingChange({id:this.props.id,config:i})},this.getWhetherHaveCustomStyle=e=>{const t=e?"regular":"hover";let s=this.props.config.getIn(["styleConfig","customStyle",t]);return s&&s.iconProps&&(s=s.without("iconProps")),!!(s&&Object.keys(s).length>0)},this.onRegularStyleChange=e=>{let t=this.props.config.setIn(["styleConfig","customStyle","regular"],e);this.getWhetherHaveCustomStyle(!1)||(t=t.setIn(["styleConfig","customStyle","hover"],this.getThemeStyle(!1))),t.getIn(["styleConfig","themeStyle"])&&(t=t.set("styleConfig",t.styleConfig.without("themeStyle"))),this.props.onSettingChange({id:this.props.id,config:t})},this.onHoverStyleChange=e=>{let t=this.props.config.setIn(["styleConfig","customStyle","hover"],e);this.getWhetherHaveCustomStyle(!0)||(t=t.setIn(["styleConfig","customStyle","regular"],this.getThemeStyle(!0))),t.getIn(["styleConfig","themeStyle"])&&(t=t.set("styleConfig",t.styleConfig.without("themeStyle"))),this.props.onSettingChange({id:this.props.id,config:t})},this.onIconPositionChange=e=>{this.props.onSettingChange({id:this.props.id,config:this.props.config.setIn(["functionConfig","icon","position"],e.target.value)})},this.onAdvanceTabSelect=e=>{const t=e===b.hover;s.builderAppSync.publishChangeWidgetStatePropToApp({widgetId:this.props.id,propKey:"isConfiguringHover",value:t})},this.mergeUseDataSources=(e,s,i)=>{const o=t.expressionUtils.getUseDataSourceFromExpParts(e&&e.parts,this.props.useDataSources),n=t.expressionUtils.getUseDataSourceFromExpParts(s&&s.parts,this.props.useDataSources),r=t.expressionUtils.getUseDataSourceFromExpParts(i&&i.parts,this.props.useDataSources);return this.mergeUseDataSourcesByDss(o,n,r)},this.mergeUseDataSourcesByDss=(e,s,i)=>{const o=this.getUseDataSourcesWithoutFields();let n=t.expressionUtils.mergeUseDataSources(o,e);return n=t.expressionUtils.mergeUseDataSources(n,s),n=t.expressionUtils.mergeUseDataSources(n,i),n},this.getUseDataSourcesWithoutFields=()=>this.props.useDataSources&&this.props.useDataSources[0]&&this.props.useDataSources[0].dataSourceId?(0,t.Immutable)([this.props.useDataSources[0].without("fields").asMutable({deep:!0})]):(0,t.Immutable)([]),this.getIsDataSourceUsed=()=>!!this.props.useDataSourcesEnabled,this.getTipExpression=()=>this.props.config&&this.props.config.functionConfig&&this.props.config.functionConfig.toolTipExpression&&this.props.config.functionConfig.toolTipExpression||(0,t.Immutable)({name:"",parts:[{type:t.ExpressionPartType.String,exp:`"${this.state.currentTipInput}"`}]}),this.getTextExpression=()=>this.props.config&&this.props.config.functionConfig&&this.props.config.functionConfig.textExpression&&this.props.config.functionConfig.textExpression||(0,t.Immutable)({name:"",parts:[{type:t.ExpressionPartType.String,exp:`"${this.state.currentTextInput}"`}]}),this.getLinkSettingExpression=()=>{var e,s,i,o,n,r,a,p,l;return this.props.config&&this.props.config.functionConfig&&this.props.config.functionConfig.linkParam&&this.props.config.functionConfig.linkParam&&this.props.config.functionConfig.linkParam.expression||((null===(i=null===(s=null===(e=this.props.config)||void 0===e?void 0:e.functionConfig)||void 0===s?void 0:s.linkParam)||void 0===i?void 0:i.linkType)===t.LinkType.WebAddress&&(null===(r=null===(n=null===(o=this.props.config)||void 0===o?void 0:o.functionConfig)||void 0===n?void 0:n.linkParam)||void 0===r?void 0:r.value)?(0,t.Immutable)({name:"",parts:[{type:t.ExpressionPartType.String,exp:`"${null===(l=null===(p=null===(a=this.props.config)||void 0===a?void 0:a.functionConfig)||void 0===p?void 0:p.linkParam)||void 0===l?void 0:l.value}"`}]}):null)},this.getThemeStyle=e=>{if(!this.props.config.getIn(["styleConfig","themeStyle"]))return(0,t.Immutable)({});const s=this.props.config.getIn(["styleConfig","themeStyle","quickStyleType"]),i=e?"default":"hover",o=this.props.appTheme.getIn(["components","button","variants",s,i])||{},r=this.props.appTheme.getIn(["components","button","sizes","default"])||{},a=parseFloat(n.styleUtils.remToPixel(r.borderRadius)),p={color:o.color,size:parseFloat(n.styleUtils.remToPixel(r.fontSize))},l={background:{color:o.bg,fillType:n.FillType.FILL},border:{type:n.NormalLineType.SOLID,color:o.border&&o.border.color,width:n.utils.stringOfLinearUnit({distance:o.border&&"string"==typeof o.border.width?parseFloat(n.styleUtils.remToPixel(o.border.width)):void 0,unit:n.UnitTypes.PIXEL})},text:{color:o.color,size:n.styleUtils.remToPixel(r.fontSize)},borderRadius:{unit:n.UnitTypes.PIXEL,number:[a,a,a,a]},iconProps:p};return(0,t.Immutable)(l)},this.openTextExpPopup=()=>{this.setState({isTextExpOpen:!0,isTipExpOpen:!1})},this.openTipExpPopup=()=>{this.setState({isTextExpOpen:!1,isTipExpOpen:!0})},this.closeTextExpPopup=()=>{this.setState({isTextExpOpen:!1,isTipExpOpen:!1})},this.closeTipExpPopup=()=>{this.setState({isTextExpOpen:!1,isTipExpOpen:!1})},this.showTextSetting=()=>!!(this.getIsDataSourceUsed()?!this.props.config.getIn(["functionConfig","textExpression"])||this.props.config.getIn(["functionConfig","textExpression"])&&this.props.config.getIn(["functionConfig","textExpression","parts"])&&(this.props.config.getIn(["functionConfig","textExpression","parts"]).length>1||'""'!==this.props.config.getIn(["functionConfig","textExpression","parts","0","exp"])):this.state.currentTextInput),this.showIconSetting=()=>!!this.props.config.getIn(["functionConfig","icon"]),this.toggleUseCustom=()=>{let e=this.props.config;e=e.setIn(["styleConfig","useCustom"],!e.getIn(["styleConfig","useCustom"])),e.getIn(["styleConfig","useCustom"])?(e=e.setIn(["styleConfig","customStyle","hover"],this.getThemeStyle(!1)),e=e.setIn(["styleConfig","customStyle","regular"],this.getThemeStyle(!0)),e=e.set("styleConfig",e.styleConfig.without("themeStyle"))):(e=e.setIn(["styleConfig","themeStyle","quickStyleType"],"default"),e=e.setIn(["styleConfig","customStyle","regular"],{iconProps:S(!0,"default",this.props.appTheme)}),e=e.setIn(["styleConfig","customStyle","hover"],{iconProps:S(!1,"default",this.props.appTheme)})),this.props.onSettingChange({id:this.props.id,config:e})},this.state={isLinkSettingShown:!1,isTextExpOpen:!1,isTipExpOpen:!1,currentTextInput:"string"==typeof(null===(r=null===(o=this.props.config)||void 0===o?void 0:o.functionConfig)||void 0===r?void 0:r.text)?null===(p=null===(a=this.props.config)||void 0===a?void 0:a.functionConfig)||void 0===p?void 0:p.text:this.props.intl.formatMessage({id:"variableButton",defaultMessage:n.defaultMessages.variableButton}),currentTipInput:this.props.config&&this.props.config.functionConfig&&this.props.config.functionConfig.toolTip||""}}componentDidUpdate(e){var t,s,i,o,r,a,p,l,g,u,c,h;this.getIsDataSourceUsed()||((null===(s=null===(t=this.props.config)||void 0===t?void 0:t.functionConfig)||void 0===s?void 0:s.text)!==(null===(o=null===(i=e.config)||void 0===i?void 0:i.functionConfig)||void 0===o?void 0:o.text)&&this.setState({currentTextInput:"string"==typeof(null===(a=null===(r=this.props.config)||void 0===r?void 0:r.functionConfig)||void 0===a?void 0:a.text)?null===(l=null===(p=this.props.config)||void 0===p?void 0:p.functionConfig)||void 0===l?void 0:l.text:this.props.intl.formatMessage({id:"variableButton",defaultMessage:n.defaultMessages.variableButton})}),(null===(u=null===(g=this.props.config)||void 0===g?void 0:g.functionConfig)||void 0===u?void 0:u.toolTip)!==(null===(h=null===(c=e.config)||void 0===c?void 0:c.functionConfig)||void 0===h?void 0:h.toolTip)&&this.setState({currentTipInput:this.props.config&&this.props.config.functionConfig&&this.props.config.functionConfig.toolTip||""}))}componentWillUnmount(){s.builderAppSync.publishChangeWidgetStatePropToApp({widgetId:this.props.id,propKey:"isConfiguringHover",value:!1})}render(){var s,p,l;const g=this.props.config.functionConfig.icon?{svg:this.props.config.functionConfig.icon.data}:null,u=this.props.config.styleConfig&&this.props.config.styleConfig.customStyle,c=this.showTextSetting(),h=this.showIconSetting(),d=c&&h;return(0,t.jsx)("div",{css:(f=this.props.theme,t.css`
    .widget-setting-link {
      overflow-y: auto;
      font-size: 13px;
      font-weight: lighter;
      .collapse-label{
        color: ${f.colors.palette.dark[400]};
      }
      .font-size-container{
        width: ${t.polished.rem(82)};
      }
    }

  `)},(0,t.jsx)("div",{className:"widget-setting-link jimu-widget"},(0,t.jsx)("div",null,(0,t.jsx)(i.SettingSection,null,(0,t.jsx)(i.SettingRow,null,(0,t.jsx)("div",{className:"choose-ds w-100"},(0,t.jsx)(r.DataSourceSelector,{types:I,useDataSources:this.props.useDataSources,useDataSourcesEnabled:this.getIsDataSourceUsed(),onToggleUseDataEnabled:this.onToggleUseDataEnabled,onChange:this.onDataSourceChange,widgetId:this.props.id})))),(0,t.jsx)(i.SettingSection,null,(0,t.jsx)(i.SettingRow,{role:"group","aria-label":this.props.intl.formatMessage({id:"setLink",defaultMessage:n.defaultMessages.setLink})},(0,t.jsx)(n.Button,{className:"w-100 text-dark set-link-btn",type:"primary",onClick:this.toggleLinkSetting,ref:this.linkSettingTrigger,title:this.props.intl.formatMessage({id:"setLink",defaultMessage:n.defaultMessages.setLink})},(0,t.jsx)("div",{className:"w-100 px-2 text-truncate"},(0,t.jsx)(T,null),this.props.intl.formatMessage({id:"setLink",defaultMessage:n.defaultMessages.setLink})))),(0,t.jsx)(i.SettingRow,{label:this.props.intl.formatMessage({id:"tooltip",defaultMessage:n.defaultMessages.tooltip})}),(0,t.jsx)(i.SettingRow,{role:"group","aria-label":this.props.intl.formatMessage({id:"tooltip",defaultMessage:n.defaultMessages.tooltip})},this.getIsDataSourceUsed()?(0,t.jsx)("div",{className:"w-100"},(0,t.jsx)(a.ExpressionInput,{useDataSources:this.props.useDataSources,onChange:this.onTipExpChange,openExpPopup:this.openTipExpPopup,expression:this.getTipExpression(),isExpPopupOpen:this.state.isTipExpOpen,closeExpPopup:this.closeTipExpPopup,types:v,widgetId:this.props.id})):(0,t.jsx)(n.TextInput,{className:"w-100",value:this.state.currentTipInput,size:"sm",onChange:e=>{this.setState({currentTipInput:e.target.value})},onBlur:()=>{this.onToolTipChange()},onKeyUp:()=>{this.onToolTipChange()}})),(0,t.jsx)(i.SettingRow,{label:this.props.intl.formatMessage({id:"text",defaultMessage:n.defaultMessages.text})}),(0,t.jsx)(i.SettingRow,{role:"group","aria-label":this.props.intl.formatMessage({id:"text",defaultMessage:n.defaultMessages.text})},this.getIsDataSourceUsed()?(0,t.jsx)("div",{className:"w-100"},(0,t.jsx)(a.ExpressionInput,{useDataSources:this.props.useDataSources,onChange:this.onTextExpChange,openExpPopup:this.openTextExpPopup,expression:this.getTextExpression(),isExpPopupOpen:this.state.isTextExpOpen,closeExpPopup:this.closeTextExpPopup,types:v,widgetId:this.props.id})):(0,t.jsx)(n.TextInput,{className:"w-100",value:this.state.currentTextInput,size:"sm",onChange:e=>{this.setState({currentTextInput:e.target.value})},onBlur:()=>{this.onTextChange()},onKeyUp:()=>{this.onTextChange()}})),(0,t.jsx)(i.SettingRow,{label:this.props.intl.formatMessage({id:"icon",defaultMessage:t.defaultMessages.icon})},(0,t.jsx)(o.IconPicker,{icon:g,configurableOption:"none",onChange:this.onIconResultChange,"aria-label":this.props.intl.formatMessage({id:"icon",defaultMessage:t.defaultMessages.icon})})),d&&(0,t.jsx)(i.SettingRow,{label:this.props.intl.formatMessage({id:"position",defaultMessage:n.defaultMessages.position})},(0,t.jsx)("div",null,(0,t.jsx)(n.Select,{onChange:this.onIconPositionChange,size:"sm",value:this.props.config.functionConfig&&this.props.config.functionConfig.icon&&this.props.config.functionConfig.icon.position,"aria-label":this.props.intl.formatMessage({id:"position",defaultMessage:n.defaultMessages.position})},Object.keys(e).map((s=>(0,t.jsx)("option",{value:e[s],key:s},this.props.intl.formatMessage({id:s.toLowerCase(),defaultMessage:n.defaultMessages[s.toLowerCase()]})))))))),(0,t.jsx)(i.SettingSection,null,(0,t.jsx)(x,{title:this.props.intl.formatMessage({id:"advance",defaultMessage:n.defaultMessages.advance}),isOpen:!!(null===(p=null===(s=this.props.config)||void 0===s?void 0:s.styleConfig)||void 0===p?void 0:p.useCustom),toggle:this.toggleUseCustom},(0,t.jsx)(n.Tabs,{fill:!0,type:"pills",onChange:this.onAdvanceTabSelect,defaultValue:b.regular},(0,t.jsx)(n.Tab,{id:b.regular,title:this.props.intl.formatMessage({id:"regular",defaultMessage:n.defaultMessages.regular})},(0,t.jsx)(m,{intl:this.props.intl,appTheme:this.props.appTheme,style:u&&u.regular,themeStyle:this.getThemeStyle(!0),onChange:this.onRegularStyleChange,isTextSettingOpen:c,isIconSettingOpen:h})),(0,t.jsx)(n.Tab,{id:b.hover,title:this.props.intl.formatMessage({id:"hover",defaultMessage:n.defaultMessages.hover})},(0,t.jsx)(m,{intl:this.props.intl,appTheme:this.props.appTheme,style:u&&u.hover,themeStyle:this.getThemeStyle(!1),onChange:this.onHoverStyleChange,isTextSettingOpen:c,isIconSettingOpen:h})))))),this.state.isLinkSettingShown&&!t.urlUtils.getAppIdPageIdFromUrl().pageId&&(0,t.jsx)(i.LinkSettingPopup,{isOpen:this.state.isLinkSettingShown,onSettingCancel:()=>{this.setState({isLinkSettingShown:!1})},onSettingConfirm:this.onSettingLinkConfirm,linkParam:this.props.config.functionConfig.linkParam,useDataSources:this.getIsDataSourceUsed()&&this.props.useDataSources,widgetId:this.props.id,trigger:null===(l=this.linkSettingTrigger)||void 0===l?void 0:l.current})));var f}}E.mapExtraStateProps=(e,s)=>({appTheme:e&&e.appStateInBuilder&&e.appStateInBuilder.theme||(0,t.Immutable)({})})})(),c})())}}}));